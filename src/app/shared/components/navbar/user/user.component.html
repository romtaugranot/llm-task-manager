<div class="user-menu" (clickOutside)="closeDropdown()">
    <button class="user-button" (click)="toggleDropdown()" [class.active]="isDropdownOpen">
        <div class="user-avatar">
            <span>{{ userInitials }}</span>
        </div>
        <div class="user-info">
            <span class="user-name">{{ userName() }}</span>
            <span class="user-email">{{ userEmail() }}</span>
        </div>
        <svg
            class="dropdown-arrow"
            [class.rotated]="isDropdownOpen"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
        >
            <polyline points="6,9 12,15 18,9"></polyline>
        </svg>
    </button>

    <!-- Dropdown Menu -->
    @if (isDropdownOpen) {
    <div class="dropdown-menu" [@slideDown]>
        <button class="dropdown-item" (click)="navigateTo('/profile')" [@scaleInOut]>
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
            >
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Profile Settings
        </button>

        <button class="dropdown-item" (click)="navigateTo('/preferences')" [@scaleInOut]>
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
            >
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6"></path>
                <path d="m21 12-6 0m-6 0-6 0"></path>
            </svg>
            Preferences
        </button>

        <button class="dropdown-item" (click)="navigateTo('/notifications')" [@scaleInOut]>
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
            >
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            Notifications
        </button>

        <div class="dropdown-divider"></div>

        <button class="dropdown-item" (click)="navigateTo('/help')" [@scaleInOut]>
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
            >
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                <circle cx="12.7" cy="16" r="0.7"></circle>
            </svg>
            Help & Support
        </button>

        <button class="dropdown-item danger" (click)="logout()" [@scaleInOut]>
            <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
            >
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16,17 21,12 16,7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Sign Out
        </button>
    </div>
    }
</div>